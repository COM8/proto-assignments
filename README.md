# protocol-assignment-1

### ToDo:
* Replace ```Sender MAC``` with something more unique to allow miltiple connetion from one NIC
* Finish File-Transfer-ACK

### Important:
* UDP MTU

### Changelog:
* 20.04.2018 [Fabian] Initial commit
* 22.04.2018 [Fabian] Protocol

## Protocol:

### General field descriptions:
Type [4 Bit]:<br/>
	0000 => Client-Hello-Handshake
	0001 => Server-Hello-Handshake
	0010 => File-Creation
	0011 => File-Transfer
	0100 => File-Transfer-ACK

Client ID [48 Bit]<br/>
	An unique client id generated by the server on first contact<br/>
	e.g. static filed with an int that gets incremented for each connected client

Checksum [16 Bit]:
	Like TCP

Sequence Number [32 bit]:<br/>
	Like TCP

### Client-Hello-Handshake:
```
0      4      20         36
+------+------+----------+
| Type | Port | Checksum |
+------+------+----------+
```

Port [16 Bit]:<br/>
	The port on which the client listens to server messages

### Server-Hello-Handshake:
```
0      4       8           56            72         88
+------+-------+-----------+-------------+----------+
| Type | Flags | Client ID | Upload-port | Checksum |
+------+-------+-----------+-------------+----------+
```
Upload-port [16 Bit]:<br/>
	The Port where the client should send all following messages to

Flags [4 Bit]:
```
0000
||||
|||+-> Client accepted
||+--> Too many clients - connection revoked
|+---> *UNUSED*
+----> *UNUSED*
```

### File-Creation:
```
0      4           52                84          86                 118
+------+-----------+-----------------+-----------+------------------+-----------+
| Type | Client ID | Sequence Number | File Type | File Name Length | File Name |
+------+-----------+-----------------+-----------+------------------+-----------+
+-------------------------+------------------+----------+
| Relat. File Path Length | Relat. File Path | Checksum |
+-------------------------+------------------+----------+
```

File Type [2 Bit]:<br/>
	00 => Folder<br/>
	01 => File<br/>
	10 => *UNUSED*<br/>
	11 => *UNUSED*<br/>

File Name Length [x Bit] **Don't forget about the MTU**

File Name Length [defined in "File Name Length" in Bit]

Relat. File Path Length [x Bit] **Don't forget about the MTU**

Relat. File Path [defined in "Relat. File Path Length" in Bit]

### File-Transfer:
```
0      4           52                84      88
+------+-----------+-----------------+-------+----------------+---------+----------+
| Type | Client ID | Sequence Number | Flags | Content Length | Content | Checksum |
+------+-----------+-----------------+-------+----------------+---------+----------+
```

Flags [4 Bit]:
```
0000
||||
|||+-> First package for the given file
||+--> File content
|+---> *UNUSED*
+----> Last package for the file
```

Content Length [x Bit] **Don't forget about the MTU**

Content [defined in "Content Length" in Bit] **Don't forget about the MTU**

### File-Transfer-ACK:
```
0      4           52                    84
+------+-----------+---------------------+
| Type | Client ID | ACK Sequence Number |
+------+-----------+---------------------+
```

ACK Sequence Number [like Sequence Number]:<br/>
	The acknowledged sequence number